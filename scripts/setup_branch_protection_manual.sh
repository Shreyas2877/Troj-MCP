#!/bin/bash

# Manual branch protection setup for v1.0.0 release branch
# This script provides step-by-step instructions for setting up branch protection

set -e

REPO="Shreyas2877/Troj-MCP"
BRANCH="v1.0.0"

echo "ğŸ”’ Setting up Branch Protection for v1.0.0"
echo "=========================================="
echo ""
echo "Since the GitHub API can be complex, here are the manual steps:"
echo ""
echo "1. ğŸŒ Go to your repository settings:"
echo "   https://github.com/$REPO/settings/branches"
echo ""
echo "2. ğŸ” Find the 'Branch protection rules' section"
echo ""
echo "3. â• Click 'Add rule' or 'Add branch protection rule'"
echo ""
echo "4. ğŸ“ Configure the following settings:"
echo ""
echo "   Branch name pattern: v1.0.0"
echo ""
echo "   âœ… Require a pull request before merging:"
echo "      - Required number of reviewers: 1"
echo "      - Dismiss stale PR approvals when new commits are pushed: âœ…"
echo "      - Require review from code owners: âŒ"
echo ""
echo "   âœ… Require status checks to pass before merging:"
echo "      - Require branches to be up to date before merging: âœ…"
echo "      - Status checks:"
echo "        - test"
echo "        - build-and-deploy"
echo ""
echo "   âŒ Restrict pushes that create files:"
echo "      - Note: User restrictions are only available for organization repositories"
echo "      - Personal repositories cannot restrict pushes to specific users"
echo ""
echo "   âœ… Allow force pushes: âŒ"
echo "   âœ… Allow deletions: âŒ"
echo ""
echo "5. ğŸ’¾ Click 'Create' or 'Save changes'"
echo ""
echo "6. âœ… Verify the protection is active by checking the branch"
echo ""
echo "ğŸ” Alternative: Use GitHub CLI (if the API works):"
echo "Run: ./scripts/setup_branch_protection.sh"
echo ""
echo "ğŸ“– For more details, see: https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/defining-the-mergeability-of-pull-requests/about-protected-branches"
